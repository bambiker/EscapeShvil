<!DOCTYPE html> 
<html> 
<script>// example of how to run the app: file:///home/nirb/Desktop/test1.html?place=rehovot
</script>
<head> 
<meta name="viewport" content="initial-scale=1.0, user-scalable=no"/> 
<meta http-equiv="content-type" content="text/html; charset=UTF-8"/> 
<link rel="stylesheet" href="bifnim.css">

<title>בפנים רחובות - סיור חידות עירוני</title> 

<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script> 
<script type="text/javascript"> 

var lat
//Get the latitude and the longitude;
function successFunction(position) {
    lat = position.coords.latitude;
    var lng = position.coords.longitude;
   // alert("latd")
    const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);
    const place = urlParams.get('place');
    rad = urlParams.get('rad');	    
    if (rad==null)
       {
    	rad = 50;
       }
	
//    document.getElementById("mylat").innerHTML = 'המיקום שלכם הוא: ' + lat + ' ,' + lng;// + '<br>https://www.google.com/maps/@'+lat+','+lng+',19z';

    myurl = window.location.href.substr(0,window.location.href.search("html")+4);
    myurloops = window.location.href.substr(0,window.location.href.search("html")-6);

    switch (place) {
	  case 'rehovot':
	    var placelat = 31.895138890168173;
	    	placelng = 34.81117684158573; 
		next = 'rehovotfirsthouse';
	    break;
	  case 'rehovotfirsthouse':
	    var placelat = 31.896045010370027;
	    	placelng = 34.812678855264146; 
		next = 'rehovotrene';
	    break;
	  case 'rehovotrene':
	    var placelat = 31.897240256120433;
	    	placelng = 34.81578298365006; 
		next = 'rehovotsara';
	    break;
	  case 'rehovotsara':
	    var placelat = 31.895667584338433;
	    	placelng = 34.81657259953825; 
		next = 'rehovotbeer2';
	    break;
	  case 'rehovotbeer2':
	    var placelat = 31.89324036929472;
	    	placelng = 34.817793497487955; 
		next = 'rehovotairplane';
	    break;
	  case 'rehovotairplane':
	    var placelat = 31.89357150508238;
	    	placelng = 34.8143536608535; 
		next = 'rehovothurt';
	    break;
	  case 'rehovothurt':
	    var placelat = 31.894229;
	    	placelng = 34.811401; 
		next = 'rehovotfin';
	    break;
	  case 'rehovotfin':
	    var placelat = 31.894229;
	    	placelng = 34.811401; 
		next = 'rehovotfin';
	    break;
	  default:
	    alert("איך הגעתם לפה??? משהו לא בסדר");
	    next = 'error'
	}

    var dist = ((lat-placelat)**2.+(lng-placelng)**2.)**.5*100000.; // gives approx meter

    if (dist<rad)
        {
      //  document.getElementById("mbar").innerHTML = "near " + dist;
	if (next=='rehovotfin')
	{	window.location.href = myurloops + "finish.html";}
	else
	{       window.location.href = myurl + "?place="+next+"&rad="+rad;}
        }
    else
        {
        document.getElementById("mbar").innerHTML = "אתם קצת רחוקים מהמיקום, נסו שנית ";
	window.location.href = myurloops + "oops.html";
        } 

}

function errorFunction(){
    alert("אנחנו לא  מצליחים לאתר את המיקום שלך, נא לבדוק את הגדרות הפלאפון");
}

function pressed() {
    navigator.geolocation.getCurrentPosition(successFunction, errorFunction);
}
	

function initialize() {
    geocoder = new google.maps.Geocoder();
}

</script> 
	    
</head>  

<body align="right" dir="rtl">
<section id="secup">
<center> בִּפְנִים 
	<br>
	רחובות </center>
</section>
<section  id="secmid">
<div id="mbar"></div>
<div id="mylat"></div>
<br>
<center>
<div id="youtube"></div>
</center>
<div id="askpostext"></div>
<center><input id="btnnext" type="button" value="בדיקת מיקום" onclick="pressed()" STYLE="color: white; font-family: Verdana; font-weight: bold; font-size: 24px; background-color: #F9AC50;border-radius: 12px;" size="24" maxlength="30">	</center>
<script>
const queryString1 = window.location.search;
const urlParams1 = new URLSearchParams(queryString1);	
const place1 = urlParams1.get('place');

document.cookie = "place=" + place1 + ";path=/";
	
	
if (place1=='rehovotfin')
	{
        document.getElementById("mylat").innerHTML = "כל הכבוד, ניצחת את המסלול<br>אתם מוזמנים להסתובב ולהכיר יותר טוב את האזור";
//	    alert("הגעתם למיקום האחרון, כל הכבוד, אתם מוזמנים להסתובב ולהכיר יותר טוב את האזור או להתחיל מסלול חדש");
            document.getElementById('btnnext').style.visibility = 'hidden';
		
	}
else
	{
	        document.getElementById('btnnext').style.visibility = 'visible';

		if (place1=='rehovot')
		{
		document.getElementById("mylat").innerHTML = "<center><br>יופי שבאת !<br>הנה רמז לתחנה הראשונה</center>";
		}
		else
		{
		document.getElementById("mylat").innerHTML = "<center><br>הנה כתב החידה לתחנה הבאה</center>";
		}
		document.getElementById("askpostext").innerHTML = "<center><br>נראה לך שהגעתם  <br>למקום הנכון? </center>";

	}
</script>

<script>
const queryString = window.location.search;
const urlParams = new URLSearchParams(queryString);
const place = urlParams.get('place');
switch (place) {
  case 'rehovot':
    var code = "MNQtUN9cBn4";
    break;
  case 'rehovotfirsthouse':
    var code = "C7WFxqulc0U";
    break;
  case 'rehovotrene':
    var code = "Tlo5P51a2Pg";
    break;
  case 'rehovotsara':
    var code = "v4BMXclf6-k";
    break;
  case 'rehovotbeer2':
    var code = "YVPAHE5QYkc";
    break;
  case 'rehovotairplane':
    var code = "v_xu2eWKfZ4";
    break;
  case 'rehovothurt':
    var code = "JAtS34-4A8M";
    break;
  case 'rehovotfin':
    var code = "0gblBX9-YuI";
    break;
  default:
      var code = "Mg8NutbV4Mc";  // should be youtube on the application or about the error
}
      var ww = window.innerWidth* 0.95
      var wh0 = window.innerHeight *0.95
      var wh = ww * 9 / 16
      if (wh>wh0)
	{ wh = wh0
	  ww = wh * 16 / 9
	}
      vid = '<iframe width='+ww+' height='+wh+' src="https://www.youtube.com/embed/'+code+'" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>';

    document.getElementById("youtube").innerHTML = vid;
</script>
	
<br><br>
הצעות לשיפור ? יש לך רעיונות למסלולים נוספים? <br>
<button onclick=" window.open('https://wa.me/972542236828','_blank')" STYLE="color: white; font-family: Verdana; font-weight: bold; font-size: 24px; background-color: #F9AC50;border-radius: 12px;" size="24" maxlength="30"> כאן !</button><br>	
</section>

<section id="down" align="left">
<img src="applogo.png" alt="logo" width="40%">
</section>

	    <!-- AddToAny BEGIN -->
<div class="a2a_kit a2a_kit_size_32 a2a_default_style" data-a2a-url="https://bambiker.github.io/bifnim/">
<a class="a2a_dd" href="https://www.addtoany.com/share"></a>
<a class="a2a_button_copy_link"></a>
<a class="a2a_button_x"></a>
<a class="a2a_button_whatsapp"></a>
<a class="a2a_button_email"></a>
<a class="a2a_button_telegram"></a>
<a class="a2a_button_facebook"></a>
<a class="a2a_button_facebook_messenger"></a>
<a class="a2a_button_google_gmail"></a>
</div>
<script async src="https://static.addtoany.com/menu/page.js"></script>
<!-- AddToAny END -->';  
    
</body> 
</html> 
